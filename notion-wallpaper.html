
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>90-Day Transformation Wallpaper</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* A very dark grey */
        }
    </style>
</head>
<body class="bg-gray-950 flex flex-col items-center justify-center min-h-screen text-gray-100 p-8">

    <div class="max-w-4xl mx-auto text-center">
        <!-- Quote container to be updated by the API -->
        <div id="quote-container" class="relative z-10 min-h-[100px] flex items-center justify-center mb-6">
            <h1 id="quote-text" class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-tight leading-tight">
                Discipline is the bridge <br class="sm:hidden">between goals <br class="sm:hidden">and accomplishment.
            </h1>
            <!-- Loading indicator that will be hidden by default -->
            <div id="loading-indicator" class="hidden text-xl sm:text-2xl md:text-3xl font-semibold text-gray-400">
                Generating...
            </div>
        </div>

        <!-- Button to generate a new quote using the Gemini API -->
        <button id="generate-button" class="bg-gray-700 hover:bg-gray-600 text-gray-200 font-bold py-3 px-6 rounded-lg transition-colors duration-200 shadow-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900">
            âœ¨ Generate a New Quote
        </button>
    </div>

    <script>
        // Get references to the DOM elements
        const generateButton = document.getElementById('generate-button');
        const quoteText = document.getElementById('quote-text');
        const loadingIndicator = document.getElementById('loading-indicator');
        const quoteContainer = document.getElementById('quote-container');

        // Function to call the Gemini API
        async function getNewQuote() {
            // Hide the existing quote and show the loading indicator
            quoteText.classList.add('hidden');
            loadingIndicator.classList.remove('hidden');
            generateButton.disabled = true; // Disable button during API call

            // The prompt for the LLM
            const prompt = "Generate a single, short, powerful, and inspiring motivational quote suitable for a wallpaper. The quote should be no more than 15 words.";

            // API payload
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            // Exponential backoff for API retries
            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    // Check if the response is successful
                    if (!response.ok) {
                        if (response.status === 429) {
                            // Too many requests, retry with exponential backoff
                            const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                            await new Promise(res => setTimeout(res, delay));
                            continue;
                        } else {
                            // Other errors, throw to exit the loop
                            throw new Error(`API call failed with status: ${response.status}`);
                        }
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const newQuote = result.candidates[0].content.parts[0].text;
                        
                        // Replace newline characters with <br> for better formatting on the page
                        const formattedQuote = newQuote.replace(/\n/g, '<br>');

                        // Update the quote on the page
                        quoteText.innerHTML = formattedQuote;
                        break; // Exit the loop on success
                    } else {
                        throw new Error("Invalid response structure from API.");
                    }
                } catch (error) {
                    console.error('Error fetching new quote:', error);
                    // On error, show a default message.
                    quoteText.innerText = "Error fetching quote. Please try again.";
                    break;
                }
            }

            // Hide loading indicator and show the new quote
            loadingIndicator.classList.add('hidden');
            quoteText.classList.remove('hidden');
            generateButton.disabled = false; // Re-enable button
        }

        // Add event listener to the button
        generateButton.addEventListener('click', getNewQuote);
    </script>

</body>
</html>

